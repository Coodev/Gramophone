package com.orobator.android.gramophone.view.fragments;import android.app.FragmentManager;import android.app.ListFragment;import android.app.LoaderManager;import android.content.Loader;import android.database.Cursor;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.CursorAdapter;import android.widget.ListView;import com.orobator.android.gramophone.R;import com.orobator.android.gramophone.model.Album;import com.orobator.android.gramophone.model.SongDatabaseHelper.AlbumCursor;import com.orobator.android.gramophone.model.loaders.AlbumCursorLoader;import com.orobator.android.gramophone.view.adapters.AlbumCursorAdapter;/** * Fragment that displays albums by a selected artist. */public class ArtistsAlbumsFragment extends ListFragment implements LoaderManager.LoaderCallbacks<Cursor> {    private static final String TAG = "ArtistsAlbumsFragment";    @Override    public Loader<Cursor> onCreateLoader(int id, Bundle args) {        return new AlbumCursorLoader(getActivity(), id, args);    }    @Override    public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {        AlbumCursor albumCursor = (AlbumCursor) cursor;        AlbumCursorAdapter adapter = new AlbumCursorAdapter(getActivity().getApplicationContext(), albumCursor);        setListAdapter(adapter);    }    @Override    public void onLoaderReset(Loader<Cursor> loader) {        setListAdapter(null);    }    @Override    public void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setRetainInstance(true);        Bundle args = getArguments();        getLoaderManager().initLoader(AlbumCursorLoader.ARTIST_ALBUMS_ID, args, this);    }    @Override    public void onDestroy() {        CursorAdapter cursorAdapter = (CursorAdapter) getListAdapter();        Cursor cursor = cursorAdapter.getCursor();        if (cursor != null) {            cursor.close();        }        super.onDestroy();    }    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup parent, Bundle savedInstanceState) {        return inflater.inflate(R.layout.list_view_albums, parent, false);    }    @Override    public void onListItemClick(ListView listView, View view, int position, long id) {        Album album = (Album) getListAdapter().getItem(position);        Bundle args = new Bundle();        args.putString(Album.KEY_ALBUM_NAME, album.getAlbumName());        args.putString(Album.KEY_ALBUM_ARTIST, album.getAlbumArtist());        AlbumSongsFragment albumSongsFragment = new AlbumSongsFragment();        albumSongsFragment.setArguments(args);        FragmentManager fm = getActivity().getFragmentManager();        fm.beginTransaction()                .replace(R.id.content_frame, albumSongsFragment)                .addToBackStack(album.getAlbumName())                .commit();    }}