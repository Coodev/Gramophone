package com.orobator.android.gramophone.view.fragments;import android.app.FragmentManager;import android.app.ListFragment;import android.app.LoaderManager;import android.content.Context;import android.content.Loader;import android.database.Cursor;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ListView;import com.orobator.android.gramophone.R;import com.orobator.android.gramophone.model.SongDatabaseHelper;import com.orobator.android.gramophone.model.SongDatabaseHelper.GenreCursor;import com.orobator.android.gramophone.model.loaders.SQLiteCursorLoader;import com.orobator.android.gramophone.view.adapters.GenreCursorAdapter;public class GenresFragment extends ListFragment implements LoaderManager.LoaderCallbacks<Cursor> {    public static final String TAG = "GenresFragment";    public static final String KEY_FOR_GENRE = "com.orobator.android.gramophone.genreKey";    @Override    public Loader<Cursor> onCreateLoader(int id, Bundle args) {        return new GenresListCursorLoader(getActivity());    }    @Override    public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {        GenreCursorAdapter adapter = new GenreCursorAdapter(getActivity().getApplicationContext(), (GenreCursor) cursor);        setListAdapter(adapter);    }    @Override    public void onLoaderReset(Loader<Cursor> loader) {        setListAdapter(null);    }    @Override    public void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setRetainInstance(true);        getLoaderManager().initLoader(0, null, this);    }    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup parent, Bundle savedInstanceState) {        View view = inflater.inflate(R.layout.list_view_genres, parent, false);        return view;    }    @Override    public void onListItemClick(ListView listView, View view, int position, long id) {        String genre = (String) getListAdapter().getItem(position);        Bundle args = new Bundle();        args.putString(KEY_FOR_GENRE, genre);        GenreSongsFragment fragment = new GenreSongsFragment();        fragment.setArguments(args);        FragmentManager fm = getActivity().getFragmentManager();        fm.beginTransaction()                .replace(R.id.content_frame, fragment)                .addToBackStack(genre)                .commit();    }    private static class GenresListCursorLoader extends SQLiteCursorLoader {        public GenresListCursorLoader(Context context) {            super(context);        }        @Override        protected Cursor loadCursor() {            return new SongDatabaseHelper(getContext()).queryGenres();        }    }}